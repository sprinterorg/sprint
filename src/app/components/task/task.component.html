<div class="task-wrap">
<section  class="task task-layer">
	<div class="task-header">
        <div class="task-title">
            {{TaskCtrl.task.title}}
        </div>
        <div class="close" 
        	 ng-click="loginController.hideFunc()">
            <a ui-sref="current-sprint({project_id: TaskCtrl.projectId})">
			<div class='close-button' 
				 ng-click="SprintCtrl.closeFullCard()"><i class="flaticon-cancel"></i></div>
			</a>
        </div>
    </div>
	
    <section class='task__wrapper'>
    	<h1 class="task__title">{{TaskCtrl.task.title}}</h1>
		<div class='task-content'>
			<section class="task-content__left-section">
			
			<div class="task__description">
				<p class="task__description-title">Task description:</p>
				<p ng-if="!TaskCtrl.editDescription" 
				   class="task__description-text">{{TaskCtrl.task.description || "no description yet"}}</p>
				<textarea ng-if="TaskCtrl.editDescription" 
						  class="textarea textarea--description" 
						  ng-model="TaskCtrl.task.description" 
						  name="description">
				</textarea>
				<button ng-if="!TaskCtrl.editDescription" 
					 class="button button--change-description" 
					 ng-click="TaskCtrl.changeDescription()">Change</button>
				<div class="edit-buttons" ng-if="TaskCtrl.editDescription">
					<button  
					 class="button button--change-save" 
					 ng-click="TaskCtrl.saveDescription()">Save</button>
					 <button  
					 class="button button--change-cancel" 
					 ng-click="TaskCtrl.cancelSavingDescription()">Cancel</button>
				</div>
			</div>
			</section>
			<section class="task-content__right-section">
				<div class="task-priority">
					<div class="priority-label">priority:</div>
					<table class="priority-priorities">
						<tr ng-repeat="priority in TaskCtrl.priorities">
							<td ng-style="{'background-color': TaskCtrl.taskPrioriry(priority)}"
								ng-click="TaskCtrl.setPriority(priority)">BV{{priority}}</td>
						</tr>
					</table>
				</div>
				<div class="task-lists">
					<div class="lists-label">is in list:</div>
					<table class="lists-lists">
						<tr ng-repeat="list in TaskCtrl.lists">
							<td 
								ng-click="TaskCtrl.setPriority(priority)">{{list.listName}}</td>
						</tr>
					</table>
				</div>
			<ul>
				<li ng-repeat="user in TaskCtrl.executors track by $index">
				{{TaskCtrl.getUser(user.$id).username}}
				<button ng-click="TaskCtrl.deleteExecutorFromTask(user.$id)">delete</button>

				</li>
			</ul>

		  <form ng-submit="TaskCtrl.addExecutorsToTask()" >
			<div class="black rounded">
			  <select
		            ng-model="TaskCtrl.newUserId"
		            ng-options="user.$id as user.username for user in TaskCtrl.projectUsers">
		      <option value="-- choose user --"></option>
		    </select>
			</div>
			<button type='submit'>Add User</button>
		  </form>

		  <h3>
			List name {{TaskCtrl.getListName()[0].listName}}
		  </h3>

		  <form ng-submit="TaskCtrl.moveToList()">
			  <div class="black rounded">
			<select
		            ng-model="TaskCtrl.newListId"
		            ng-options="list.listId as list.listName for list in TaskCtrl.lists">
		      <option value="-- choose user --"></option>
		    </select>
			  </div>
			<button type='submit'>Move to another list</button>
		  </form>
		
		</section>
		</div>
	</section>
	<section class="comments-section">
	<div class="add-comment">
		<textarea class="textarea textarea--add-comment" ng-model="TaskCtrl.comment" name="comment" placeholder="Your comment">
		</textarea>
	<button class="button button--send" ng-click="TaskCtrl.addComment()">Add comment</button>
	</div>

	<div ng-repeat="comment in TaskCtrl.comments" class="comments user-comment">
		<img src="{{TaskCtrl.getUser(comment.userId).avatar}}" alt="" class="comment-avatar">
		<div class="comment-body">
			<div class="comment-in">
				<div class="user-name">{{TaskCtrl.getUser(comment.userId).username}}</div>

				<span ng-hide="TaskCtrl.editCommentId === comment.$id"  class="comment-text">{{comment.comment}}</span>

				<textarea ng-if="TaskCtrl.editMode && TaskCtrl.editCommentId === comment.$id" ng-model="TaskCtrl.commentText"></textarea>

				<span ng-show="comment.userId === TaskCtrl.userId" ng-click="TaskCtrl.deleteComment(comment.$id)" class="close"></span>

				<span ng-show="comment.userId === TaskCtrl.userId && !TaskCtrl.editMode &&
				!(TaskCtrl.editCommentId === comment.$id)" ng-click="TaskCtrl.editComment(comment)" class="edit-comment">edit</span>

				<span ng-show="TaskCtrl.editMode && TaskCtrl.editCommentId === comment.$id"
					  ng-click="TaskCtrl.saveEditedComment(comment.$id)" class="edit-comment">save</span>
			</div>
		</div>
	</div>
</section>
</section>


</div>